<!DOCTYPE html>

<head>
	<title>James Mernin Assignment 2</title>
    <meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="style.css" />

	<script>

        function doMapChat() {
        	var myCoords = getCoords();
        	sendLoc(myCoords);
        }

		function getCoords() {
		    myCoords = navigator.geolocation.getCurrentPosition(success).coords;
		    return myCoords;
		};

		function success(myPos) {
			var crd = myPos.coords;
		    console.log('Latitude: ' + crd.latitude);
		    console.log('Longitude: ' + crd.longitude);
		};

		function sendLoc(crd) {
			var xhr = new XMLHttpRequest();
			var url = "https://secret-about-box.herokuapp.com/sendLocation";
			var params = "login=KeithRumfelt&lat=" + crd.latitude + "&lng=" + crd.longitude + "&message=Here I am!";

			xhr.open("POST", url, true);
			xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

			xhr.onreadystatechange = function() {
		    	if (xhr.readyState == 4 && xhr.status == 200) {
		    		alert(xhr.responseText);
		    	};
		    };

		    xhr.send(params);
		};
	</script>

</head>

<body onload="doMapChat()">
	<h1>Map Chat</h1>
</body>

</html>