<!DOCTYPE html>

<head>
	<title>James Mernin Assignment 2</title>
        <meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="style.css" />

	<script>
        var x = document.getElementById("mapchat");

        function doMapChat() {
        	var myCoords = getCoords();
        	sendLoc(myCoords);
        }

		function getCoords() {
		    return navigator.geolocation.getCurrentPosition(success).coords;
		};

		function success() {
			var crd = myPos.coords;
		    console.log('Latitude: ' + crd.latitude);
		    console.log('Longitude: ' + crd.longitude);
		}

		function sendLoc(crd) {
			var xmlhttp = new XMLHttpRequest();
			var url = "http://tuftsdev.github.io/comp20-username/mapchat";
			var params = "login=KeithRumfelt&lat=" + crd.latitude + "&lng=" + crd.longitude + "&message=Here I am!";

			xmlhttp.open("POST", url, true);
			xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

			xmlhttp.onreadystatechange = function() {
		    	if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
		    		alert(xmlhttp.responseText);
		    	};
		    };

		    xmlhttp.send(params);
		};
	</script>

</head>

<body onload="doMapChat()">
	<div id="mapchat"></div>
	<h1>Map Chat</h1>
</body>

</html>