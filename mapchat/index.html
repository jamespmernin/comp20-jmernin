<!DOCTYPE html>

<head>
	<title>James Mernin Assignment 2</title>
        <meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="style.css" />

	<script>
        var x = document.getElementById("mapchat");

		function getMyPos() {
		    myLoc = navigator.geolocation;
		    myPos = myLoc.getCurrentPosition(getPosition)

		    sendLoc(myPos)
		};

        function getPosition(position) {
		    var crd = position.coords;
		    console.log('Latitude: ' + crd.latitude);
		    console.log('Longitude: ' + crd.longitude);
		};

		function sendLoc(position) {
			var xml_http = new XMLHttpRequest();
			var url = "http://tuftsdev.github.io/comp20-username/mapchat";
			var params = "login=KeithRumfelt&lat=" + position.coords.latitude + "&lng=" + position.coords.longitude + "&message=Here I am!"

			xml_http.open("POST", url, true);
			xml_http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

		    xml_http.onreadystatechange = function() {
		    	if (xml_http.readyState == 4 && xml_http.status == 200) {
		    		alert(xml_http.responseText);
		    	};
		    };

		    xml_http.send(params);
		};
	</script>

</head>

<body onload="getMyPos()">
	<div id="mapchat"></div>
	<h1>Map Chat</h1>
</body>

</html>